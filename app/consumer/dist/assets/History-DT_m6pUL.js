import{j as e}from"./index-Dr5LwVtT.js";import{u as a,r as s}from"./react-vendor-DQcjAbTS.js";import{u as t,V as l}from"./useScanHistory-C_Jdk5j4.js";import{g as r}from"./trust-score-BT4cMY15.js";const n="_container_1wfj7_1",c="_header_1wfj7_49",i="_title_1wfj7_59",o="_description_1wfj7_73",d="_controls_1wfj7_85",_="_filterSection_1wfj7_99",m="_filterLabel_1wfj7_111",j="_searchBox_1wfj7_127",u="_searchInput_1wfj7_135",h="_filters_1wfj7_177",p="_filterButton_1wfj7_191",w="_filterButtonActive_1wfj7_237",x="_clearButton_1wfj7_249",f="_list_1wfj7_293",N="_itemWrapper_1wfj7_305",b="_item_1wfj7_305",y="_thumbnail_1wfj7_367",C="_thumbnailImage_1wfj7_385",g="_itemContent_1wfj7_397",v="_itemHeader_1wfj7_407",$="_itemName_1wfj7_421",k="_unknownItem_1wfj7_443",S="_renameButton_1wfj7_453",I="_itemBrandCategory_1wfj7_505",T="_itemBrand_1wfj7_505",B="_itemCategory_1wfj7_531",A="_itemSeparator_1wfj7_539",H="_itemMeta_1wfj7_547",D="_itemSource_1wfj7_565",L="_sourceIcon_1wfj7_589",V="_sourceLabel_1wfj7_599",M="_itemScore_1wfj7_607",W="_itemTimestamp_1wfj7_615",R="_itemVerdict_1wfj7_623",P="_rescanButton_1wfj7_633",U="_rescanIcon_1wfj7_693",E="_rescanText_1wfj7_703",F="_empty_1wfj7_715",G="_emptyIcon_1wfj7_725",J="_emptyTitle_1wfj7_737",Y="_emptyText_1wfj7_751",q="_scanButton_1wfj7_769",z="_modal_1wfj7_815",K="_modalContent_1wfj7_845",O="_modalTitle_1wfj7_863",Q="_modalText_1wfj7_877",X="_modalActions_1wfj7_891",Z="_modalButtonCancel_1wfj7_901",ee="_modalButtonConfirm_1wfj7_903";function ae(e){switch(e){case"url":return"ðŸŒ";case"screenshot":return"ðŸ“¸";case"barcode":return"ðŸ“Š";case"text":return"ðŸ“";default:return"ðŸ”"}}function se(e){switch(e){case"url":return"Web URL";case"screenshot":return"Screenshot";case"barcode":return"Barcode";case"text":return"Text";default:return"Scan"}}function te(){const te=a(),{history:le,clearHistory:re,renameScan:ne}=t(),[ce,ie]=s.useState(""),[oe,de]=s.useState("all"),[_e,me]=s.useState("all"),[je,ue]=s.useState("all"),[he,pe]=s.useState(!1),we=le.filter(e=>{const a=e.productName.toLowerCase().includes(ce.toLowerCase()),s="all"===oe||e.verdict===oe,t="all"===_e||e.categories&&e.categories.includes(_e);let l=!0;if("all"!==je){const a=(Date.now()-e.timestamp)/864e5;"today"===je?l=a<1:"week"===je?l=a<7:"month"===je&&(l=a<30)}return a&&s&&t&&l}),xe=e=>{const a=new Date(e),s=(new Date).getTime()-a.getTime(),t=Math.floor(s/6e4),l=Math.floor(s/36e5),r=Math.floor(s/864e5);return t<1?"Just now":t<60?`${t}m ago`:l<24?`${l}h ago`:r<7?`${r}d ago`:a.toLocaleDateString()};return e.jsxs("div",{className:n,children:[e.jsxs("div",{className:c,children:[e.jsx("h1",{className:i,children:"Scan History"}),e.jsxs("p",{className:o,children:[le.length," scan",1!==le.length?"s":""," saved (max 50)"]})]}),le.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:d,children:[e.jsx("div",{className:j,children:e.jsx("input",{type:"text",className:u,placeholder:"Search by product name...",value:ce,onChange:e=>ie(e.target.value),"aria-label":"Search scan history"})}),e.jsxs("div",{className:_,children:[e.jsx("label",{className:m,children:"Verdict"}),e.jsxs("div",{className:h,children:[e.jsx("button",{className:`${p} ${"all"===oe?w:""}`,onClick:()=>de("all"),"aria-pressed":"all"===oe,children:"All"}),e.jsx("button",{className:`${p} ${"allow"===oe?w:""}`,onClick:()=>de("allow"),"aria-pressed":"allow"===oe,children:"Allow"}),e.jsx("button",{className:`${p} ${"caution"===oe?w:""}`,onClick:()=>de("caution"),"aria-pressed":"caution"===oe,children:"Caution"}),e.jsx("button",{className:`${p} ${"avoid"===oe?w:""}`,onClick:()=>de("avoid"),"aria-pressed":"avoid"===oe,children:"Avoid"})]})]}),e.jsxs("div",{className:_,children:[e.jsx("label",{className:m,children:"Category"}),e.jsxs("div",{className:h,children:[e.jsx("button",{className:`${p} ${"all"===_e?w:""}`,onClick:()=>me("all"),"aria-pressed":"all"===_e,children:"All"}),e.jsx("button",{className:`${p} ${"allergens"===_e?w:""}`,onClick:()=>me("allergens"),"aria-pressed":"allergens"===_e,children:"Allergens"}),e.jsx("button",{className:`${p} ${"banned_claims"===_e?w:""}`,onClick:()=>me("banned_claims"),"aria-pressed":"banned_claims"===_e,children:"Banned Claims"}),e.jsx("button",{className:`${p} ${"weasel_words"===_e?w:""}`,onClick:()=>me("weasel_words"),"aria-pressed":"weasel_words"===_e,children:"Weasel Words"})]})]}),e.jsxs("div",{className:_,children:[e.jsx("label",{className:m,children:"Date"}),e.jsxs("div",{className:h,children:[e.jsx("button",{className:`${p} ${"all"===je?w:""}`,onClick:()=>ue("all"),"aria-pressed":"all"===je,children:"All Time"}),e.jsx("button",{className:`${p} ${"today"===je?w:""}`,onClick:()=>ue("today"),"aria-pressed":"today"===je,children:"Today"}),e.jsx("button",{className:`${p} ${"week"===je?w:""}`,onClick:()=>ue("week"),"aria-pressed":"week"===je,children:"This Week"}),e.jsx("button",{className:`${p} ${"month"===je?w:""}`,onClick:()=>ue("month"),"aria-pressed":"month"===je,children:"This Month"})]})]}),e.jsx("button",{className:x,onClick:()=>pe(!0),"aria-label":"Clear all scan history",children:"Clear History"})]}),0===we.length?e.jsx("div",{className:F,children:e.jsx("p",{className:Y,children:"No scans match your search or filter."})}):e.jsx("div",{className:f,children:we.map(a=>{var s;const t=r(a.trustScore),n=(null==(s=a.productIdentity)?void 0:s.name)||a.productName,c=!n||"Unknown Item"===n;return e.jsxs("div",{className:N,children:[e.jsxs("button",{className:b,onClick:()=>(e=>{te(`/results?data=${e.resultData}`)})(a),"aria-label":`View scan results for ${n}`,children:[a.thumbnail&&e.jsx("div",{className:y,children:e.jsx("img",{src:a.thumbnail,alt:"",className:C})}),e.jsxs("div",{className:g,children:[e.jsxs("div",{className:v,children:[e.jsx("h3",{className:`${$} ${c?k:""}`,children:n}),c&&e.jsx("button",{className:S,onClick:e=>((e,a,s)=>{e.stopPropagation();const t=prompt("Enter product name:",s||"");t&&t.trim()&&t!==s&&ne(a,t.trim())})(e,a.id,n),"aria-label":"Rename product",title:"Rename product",children:"âœï¸ Rename"})]}),a.productIdentity&&(a.productIdentity.brand||a.productIdentity.category)&&e.jsxs("div",{className:I,children:[a.productIdentity.brand&&e.jsx("span",{className:T,children:a.productIdentity.brand}),a.productIdentity.brand&&a.productIdentity.category&&e.jsx("span",{className:A,children:"â€¢"}),a.productIdentity.category&&e.jsx("span",{className:B,children:a.productIdentity.category})]}),e.jsxs("div",{className:H,children:[a.productIdentity&&e.jsxs("span",{className:D,children:[e.jsx("span",{className:L,"aria-hidden":"true",children:ae(a.productIdentity.sourceType)}),e.jsx("span",{className:V,children:a.productIdentity.sourceLabel||se(a.productIdentity.sourceType)})]}),e.jsxs("span",{className:M,children:["Score: ",a.trustScore]}),e.jsx("span",{className:W,children:xe(a.timestamp)})]})]}),e.jsx("div",{className:R,children:e.jsx(l,{verdict:t,compact:!0})})]}),e.jsxs("button",{className:P,onClick:e=>((e,a)=>{e.stopPropagation(),te(`/results?data=${a.resultData}`)})(e,a),"aria-label":`View details for ${n}`,title:"View details",children:[e.jsx("span",{className:U,children:"ðŸ‘ï¸"}),e.jsx("span",{className:E,children:"View"})]})]},a.id)})})]}),0===le.length&&e.jsxs("div",{className:F,children:[e.jsx("div",{className:G,children:"ðŸ“‹"}),e.jsx("h2",{className:J,children:"No Scan History"}),e.jsx("p",{className:Y,children:"Your scanned products will appear here. Start scanning to build your history!"}),e.jsx("button",{className:q,onClick:()=>te("/scan"),children:"Go to Scan Hub"})]}),he&&e.jsx("div",{className:z,onClick:()=>pe(!1),role:"dialog","aria-modal":"true","aria-labelledby":"clear-confirm-title",children:e.jsxs("div",{className:K,onClick:e=>e.stopPropagation(),children:[e.jsx("h2",{id:"clear-confirm-title",className:O,children:"Clear All History?"}),e.jsxs("p",{className:Q,children:["This will permanently delete all ",le.length," scan",1!==le.length?"s":""," from your history. This action cannot be undone."]}),e.jsxs("div",{className:X,children:[e.jsx("button",{className:Z,onClick:()=>pe(!1),children:"Cancel"}),e.jsx("button",{className:ee,onClick:()=>{re(),pe(!1)},children:"Clear History"})]})]})})]})}export{te as default};
